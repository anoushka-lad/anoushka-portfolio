<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Collage Position Tool</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: #1a1a1a;
    color: #fff;
    overflow: hidden;
    height: 100vh;
  }

  #toolbar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 48px;
    background: #2a2a2a;
    display: flex;
    align-items: center;
    padding: 0 16px;
    gap: 12px;
    z-index: 1000;
    border-bottom: 1px solid #444;
    font-size: 13px;
  }

  #toolbar button {
    padding: 6px 14px;
    border-radius: 6px;
    border: 1px solid #555;
    background: #333;
    color: #fff;
    cursor: pointer;
    font-size: 12px;
  }
  #toolbar button:hover { background: #444; }
  #toolbar button.primary { background: #2563eb; border-color: #3b82f6; }
  #toolbar button.primary:hover { background: #1d4ed8; }

  #toolbar .separator { width: 1px; height: 24px; background: #555; }

  #toolbar .info {
    color: #aaa;
    font-size: 12px;
    margin-left: auto;
    display: flex;
    gap: 16px;
    align-items: center;
  }
  #canvas-dims {
    color: #666;
    font-size: 11px;
    font-family: monospace;
  }

  #canvas-area {
    position: absolute;
    top: 48px;
    left: 0;
    right: 300px;
    bottom: 0;
    background: #FFFCF6;
    overflow: hidden;
  }

  #collage-container {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }

  .collage-item {
    position: absolute;
    cursor: grab;
    user-select: none;
    transition: box-shadow 0.15s;
  }
  .collage-item:hover { box-shadow: 0 0 0 2px #2563eb; }
  .collage-item.selected { box-shadow: 0 0 0 2px #f59e0b; }
  .collage-item.dragging { cursor: grabbing; opacity: 0.85; }

  .collage-item img {
    width: 100%;
    height: auto;
    pointer-events: none;
    display: block;
  }

  .resize-handle {
    position: absolute;
    bottom: -4px;
    right: -4px;
    width: 12px;
    height: 12px;
    background: #2563eb;
    border: 2px solid #fff;
    border-radius: 2px;
    cursor: se-resize;
    display: none;
  }
  .collage-item.selected .resize-handle { display: block; }

  /* Anchor indicator */
  .anchor-indicator {
    position: absolute;
    top: 3px;
    width: 0;
    height: 0;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
  }
  .collage-item.selected .anchor-indicator,
  .collage-item:hover .anchor-indicator { opacity: 0.8; }
  .anchor-left .anchor-indicator {
    left: 3px;
    border-top: 6px solid #22c55e;
    border-right: 6px solid transparent;
  }
  .anchor-right .anchor-indicator {
    right: 3px;
    border-top: 6px solid #a855f7;
    border-left: 6px solid transparent;
  }

  #sidebar {
    position: fixed;
    top: 48px;
    right: 0;
    width: 300px;
    bottom: 0;
    background: #2a2a2a;
    overflow-y: auto;
    border-left: 1px solid #444;
    padding: 12px;
  }

  #sidebar h3 {
    font-size: 13px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #ccc;
  }

  .prop-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
    font-size: 12px;
  }
  .prop-row label {
    width: 60px;
    color: #999;
    flex-shrink: 0;
  }
  .prop-row input {
    flex: 1;
    background: #333;
    border: 1px solid #555;
    border-radius: 4px;
    padding: 4px 8px;
    color: #fff;
    font-size: 12px;
    width: 60px;
  }

  .anchor-toggle {
    display: flex;
    flex: 1;
  }
  .anchor-toggle button {
    flex: 1;
    padding: 3px 10px;
    border: 1px solid #555;
    background: #333;
    color: #999;
    cursor: pointer;
    font-size: 11px;
  }
  .anchor-toggle button:first-child {
    border-radius: 4px 0 0 4px;
  }
  .anchor-toggle button:last-child {
    border-radius: 0 4px 4px 0;
    border-left: none;
  }
  .anchor-toggle button.active-left {
    background: #166534;
    color: #86efac;
    border-color: #22c55e;
  }
  .anchor-toggle button.active-right {
    background: #581c87;
    color: #d8b4fe;
    border-color: #a855f7;
  }

  .item-list-entry {
    padding: 6px 8px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    margin-bottom: 2px;
    display: flex;
    justify-content: space-between;
  }
  .item-list-entry:hover { background: #333; }
  .item-list-entry.active { background: #2563eb33; color: #60a5fa; }
  .item-list-entry .anchor-badge {
    font-size: 10px;
    font-weight: 600;
    padding: 0 4px;
    border-radius: 2px;
    margin-right: 4px;
  }
  .anchor-badge.left { background: #166534; color: #86efac; }
  .anchor-badge.right { background: #581c87; color: #d8b4fe; }

  #mockup-overlay {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    pointer-events: none;
    opacity: 0.3;
    object-fit: cover;
    display: none;
  }

  #center-text {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    pointer-events: none;
    z-index: 10;
  }
  #center-text h1 {
    font-family: 'Cormorant Garamond', 'Georgia', serif;
    font-size: clamp(2.5rem, 5vw, 4.5rem);
    color: #343434;
    font-weight: 400;
    line-height: 1.1;
  }
  #center-text p {
    font-family: 'Inter', sans-serif;
    font-size: clamp(0.7rem, 1.2vw, 1rem);
    color: #343434;
    letter-spacing: 0.3em;
    margin-top: 8px;
    text-transform: uppercase;
  }

  #export-modal {
    display: none;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.8);
    z-index: 2000;
    justify-content: center;
    align-items: center;
  }
  #export-modal.show { display: flex; }
  #export-modal pre {
    background: #1e1e1e;
    color: #d4d4d4;
    padding: 24px;
    border-radius: 8px;
    max-width: 800px;
    max-height: 80vh;
    overflow: auto;
    font-size: 12px;
    line-height: 1.5;
    white-space: pre;
  }
  #export-modal .close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    background: #555;
    color: #fff;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
  }
</style>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>

<div id="toolbar">
  <strong style="color:#f59e0b">Collage Positioner</strong>
  <div class="separator"></div>
  <button onclick="toggleMockup()">Toggle Mockup Overlay</button>
  <button onclick="adjustOpacity(-0.1)">Mockup −</button>
  <button onclick="adjustOpacity(0.1)">Mockup +</button>
  <div class="separator"></div>
  <button class="primary" onclick="exportPositions()">Export Coordinates</button>
  <button onclick="copyExport()">Copy to Clipboard</button>
  <div class="info">
    <span id="status">Drag images to position. All values in px.</span>
    <span id="canvas-dims"></span>
  </div>
</div>

<div id="canvas-area">
  <div id="collage-container">
    <img id="mockup-overlay" src="" alt="mockup">
    <div id="center-text">
      <h1>Anoushka Lad</h1>
      <p>Product & Research</p>
    </div>
  </div>
</div>

<div id="sidebar">
  <h3>SELECTED ELEMENT</h3>
  <div id="props-panel" style="margin-bottom:16px;">
    <div style="color:#666;font-size:12px;">Click an element to select it</div>
  </div>

  <h3>ALL ELEMENTS</h3>
  <div id="item-list"></div>
</div>

<div id="export-modal">
  <button class="close-btn" onclick="closeExport()">Close</button>
  <pre id="export-code"></pre>
</div>

<script>
// Raw item definitions — positions in old vw/vh units, converted to px on init
const itemDefs = [
  { id: 'tiger-stamp', src: '/images/collage/tiger-stamp.png', xVw: 1, yVh: 1, sizeVw: 3.5, rotation: -3, zIndex: 10, anchor: 'left' },
  { id: 'blue-dragon', src: '/images/collage/blue-dragon.png', xVw: -7, yVh: 6, sizeVw: 20, rotation: 0, zIndex: 5, anchor: 'left' },
  { id: 'disco-ball', src: '/images/collage/disco-ball.png', xVw: 19, yVh: -10, sizeVw: 14, rotation: 0, zIndex: 7, anchor: 'left' },
  { id: 'concert-ticket', src: '/images/collage/concert-ticket.png', xVw: 14, yVh: 22, sizeVw: 9, rotation: -6, zIndex: 6, anchor: 'left' },
  { id: 'gold-frame-bunny', src: '/images/collage/gold-frame-bunny.png', xVw: 56, yVh: -2, sizeVw: 18, rotation: 3, zIndex: 5, anchor: 'right' },
  { id: 'coffee-ring', src: '/images/collage/coffee-ring.png', xVw: 76, yVh: 1, sizeVw: 5.5, rotation: 0, zIndex: 9, anchor: 'right' },
  { id: 'sun-face', src: '/images/collage/sun-face.png', xVw: 82, yVh: 15, sizeVw: 26, rotation: 0, zIndex: 3, anchor: 'right' },
  { id: 'bookshelf', src: '/images/collage/bookshelf.png', xVw: -8, yVh: 32, sizeVw: 26, rotation: 0, zIndex: 2, anchor: 'left' },
  { id: 'earring-back', src: '/images/collage/earring.png', xVw: 17, yVh: 34, sizeVw: 3, rotation: -8, zIndex: 7, anchor: 'left' },
  { id: 'earring-front', src: '/images/collage/earring.png', xVw: 18.5, yVh: 36, sizeVw: 2.5, rotation: 5, zIndex: 8, anchor: 'left' },
  { id: 'f1-car', src: '/images/collage/f1-car.png', xVw: 3, yVh: 56, sizeVw: 28, rotation: -2, zIndex: 6, anchor: 'left' },
  { id: 'card-spades', src: '/images/collage/playing-card-spades.png', xVw: 66, yVh: 30, sizeVw: 10, rotation: 14, zIndex: 5, anchor: 'right' },
  { id: 'card-queen', src: '/images/collage/playing-card-queen.png', xVw: 63, yVh: 28, sizeVw: 11, rotation: 4, zIndex: 6, anchor: 'right' },
  { id: 'cd-disc', src: '/images/collage/cd-disc.png', xVw: 60, yVh: 50, sizeVw: 10, rotation: -5, zIndex: 7, anchor: 'right' },
  { id: 'letter-T-1', src: '/images/collage/letter-T.png', xVw: 53, yVh: 75, sizeVw: 3.2, rotation: -4, zIndex: 8, anchor: 'right' },
  { id: 'letter-H-1', src: '/images/collage/letter-H.png', xVw: 56.5, yVh: 74.5, sizeVw: 3.2, rotation: 2, zIndex: 8, anchor: 'right' },
  { id: 'letter-A', src: '/images/collage/letter-A.png', xVw: 60, yVh: 75.2, sizeVw: 3.2, rotation: -1, zIndex: 8, anchor: 'right' },
  { id: 'letter-T-2', src: '/images/collage/letter-T.png', xVw: 63.5, yVh: 74.8, sizeVw: 3.2, rotation: 3, zIndex: 8, anchor: 'right' },
  { id: 'letter-S', src: '/images/collage/letter-S.png', xVw: 68, yVh: 75, sizeVw: 3.2, rotation: -2, zIndex: 8, anchor: 'right' },
  { id: 'letter-H-2', src: '/images/collage/letter-H.png', xVw: 57, yVh: 81, sizeVw: 3.2, rotation: 1, zIndex: 8, anchor: 'right' },
  { id: 'letter-O', src: '/images/collage/letter-O.png', xVw: 60.5, yVh: 81.5, sizeVw: 3.2, rotation: -3, zIndex: 8, anchor: 'right' },
  { id: 'letter-T-3', src: '/images/collage/letter-T.png', xVw: 64, yVh: 81, sizeVw: 3.2, rotation: 5, zIndex: 8, anchor: 'right' },
  { id: 'peony-back', src: '/images/collage/peony.png', xVw: 76, yVh: 64, sizeVw: 22, rotation: -5, zIndex: 3, anchor: 'right' },
  { id: 'peony-front', src: '/images/collage/peony.png', xVw: 70, yVh: 68, sizeVw: 17, rotation: 8, zIndex: 5, anchor: 'right' },
];

const items = [];
let selected = null;
let dragging = null;
let resizing = null;
let dragOffset = { x: 0, y: 0 };
let mockupOpacity = 0.3;
const container = document.getElementById('collage-container');

function getCanvasEl() {
  return document.getElementById('canvas-area');
}

function getCanvasRect() {
  return getCanvasEl().getBoundingClientRect();
}

// Convert initial vw/vh definitions to px-based items
function initItems() {
  const canvasW = getCanvasEl().offsetWidth;
  const vw = window.innerWidth;
  const vh = window.innerHeight;

  itemDefs.forEach(def => {
    // vw/vh → px (vw/vh are relative to full viewport, which is how the old tool applied them)
    const leftPx = (def.xVw / 100) * vw;
    const topPx = (def.yVh / 100) * vh;
    const widthPx = (def.sizeVw / 100) * vw;

    let x;
    if (def.anchor === 'right') {
      // Convert from left-based px to right-distance px within canvas
      x = Math.round(canvasW - leftPx - widthPx);
    } else {
      x = Math.round(leftPx);
    }

    items.push({
      id: def.id,
      src: def.src,
      x: x,
      y: Math.round(topPx),
      width: Math.round(widthPx),
      rotation: def.rotation,
      zIndex: def.zIndex,
      anchor: def.anchor,
    });
  });
}

// Create DOM elements for each item
function createElements() {
  items.forEach((item, i) => {
    const div = document.createElement('div');
    div.className = 'collage-item anchor-' + item.anchor;
    div.dataset.index = i;

    const img = document.createElement('img');
    img.src = item.src;
    img.alt = item.id;
    img.draggable = false;
    img.onerror = function() {
      this.style.display = 'none';
      div.style.background = '#ddd';
      div.style.border = '1px dashed #999';
      div.style.aspectRatio = '1';
      div.style.display = 'flex';
      div.style.alignItems = 'center';
      div.style.justifyContent = 'center';
      div.style.fontSize = '10px';
      div.style.color = '#666';
      div.textContent = item.id;
    };

    const handle = document.createElement('div');
    handle.className = 'resize-handle';

    const indicator = document.createElement('div');
    indicator.className = 'anchor-indicator';

    div.appendChild(img);
    div.appendChild(handle);
    div.appendChild(indicator);
    container.appendChild(div);

    updateElement(i);

    // Drag start
    div.addEventListener('mousedown', (e) => {
      if (e.target === handle) return;
      e.preventDefault();
      selectItem(i);
      dragging = i;
      const rect = div.getBoundingClientRect();
      dragOffset.x = e.clientX - rect.left;
      dragOffset.y = e.clientY - rect.top;
      div.classList.add('dragging');
    });

    // Resize start
    handle.addEventListener('mousedown', (e) => {
      e.preventDefault();
      e.stopPropagation();
      resizing = i;
    });
  });
}

function updateElement(index) {
  const item = items[index];
  const el = container.children[index + 2]; // +2 for mockup overlay + center text

  if (item.anchor === 'right') {
    el.style.left = 'auto';
    el.style.right = item.x + 'px';
  } else {
    el.style.right = 'auto';
    el.style.left = item.x + 'px';
  }
  el.style.top = item.y + 'px';
  el.style.width = item.width + 'px';
  el.style.transform = `rotate(${item.rotation}deg)`;
  el.style.zIndex = item.zIndex;
}

// ---- Mouse handlers ----

document.addEventListener('mousemove', (e) => {
  const canvasRect = getCanvasRect();

  if (dragging !== null) {
    const item = items[dragging];
    const leftPx = e.clientX - dragOffset.x - canvasRect.left;
    const topPx = e.clientY - dragOffset.y - canvasRect.top;

    if (item.anchor === 'right') {
      item.x = Math.round(canvasRect.width - leftPx - item.width);
    } else {
      item.x = Math.round(leftPx);
    }
    item.y = Math.round(topPx);

    updateElement(dragging);
    updateProps();
  }

  if (resizing !== null) {
    const item = items[resizing];
    const el = container.children[resizing + 2];
    const rect = el.getBoundingClientRect();
    const newWidth = Math.max(20, Math.round(e.clientX - rect.left));

    if (item.anchor === 'right') {
      // Keep left edge visually fixed: recalculate right distance
      const leftEdge = rect.left - canvasRect.left;
      item.x = Math.round(canvasRect.width - leftEdge - newWidth);
    }

    item.width = newWidth;
    updateElement(resizing);
    updateProps();
  }
});

document.addEventListener('mouseup', () => {
  if (dragging !== null) {
    container.children[dragging + 2].classList.remove('dragging');
    dragging = null;
  }
  resizing = null;
});

// ---- Keyboard controls ----

document.addEventListener('keydown', (e) => {
  if (selected === null) return;
  if (document.activeElement.tagName === 'INPUT') return;

  const item = items[selected];
  const step = e.shiftKey ? 10 : 1;

  switch(e.key) {
    case 'ArrowLeft':
      // Visually moves left: for left-anchor decrease x, for right-anchor increase x
      item.x += (item.anchor === 'right') ? step : -step;
      break;
    case 'ArrowRight':
      item.x += (item.anchor === 'right') ? -step : step;
      break;
    case 'ArrowUp': item.y -= step; break;
    case 'ArrowDown': item.y += step; break;
    case '[': item.rotation -= 1; break;
    case ']': item.rotation += 1; break;
    case '-': item.width = Math.max(20, item.width - 5); break;
    case '=': case '+': item.width += 5; break;
    case ',': item.zIndex = Math.max(1, item.zIndex - 1); break;
    case '.': item.zIndex += 1; break;
    default: return;
  }
  e.preventDefault();
  updateElement(selected);
  updateProps();
  updateList();
});

// ---- Selection & props ----

function selectItem(index) {
  if (selected !== null) {
    container.children[selected + 2].classList.remove('selected');
  }
  selected = index;
  container.children[index + 2].classList.add('selected');
  updateProps();
  updateList();
}

function setAnchor(newAnchor) {
  if (selected === null) return;
  const item = items[selected];
  if (item.anchor === newAnchor) return;

  const canvasW = getCanvasEl().offsetWidth;
  // Convert x to maintain the same visual position
  item.x = canvasW - item.x - item.width;
  item.anchor = newAnchor;

  // Update element class for indicator
  const el = container.children[selected + 2];
  el.classList.remove('anchor-left', 'anchor-right');
  el.classList.add('anchor-' + newAnchor);

  updateElement(selected);
  updateProps();
  updateList();
}

function updateProps() {
  const panel = document.getElementById('props-panel');
  if (selected === null) {
    panel.innerHTML = '<div style="color:#666;font-size:12px;">Click an element to select it</div>';
    return;
  }
  const item = items[selected];
  const posLabel = item.anchor === 'right' ? 'Right' : 'Left';
  const leftActiveClass = item.anchor === 'left' ? 'active-left' : '';
  const rightActiveClass = item.anchor === 'right' ? 'active-right' : '';
  panel.innerHTML = `
    <div style="font-weight:600;margin-bottom:8px;color:#f59e0b;">${item.id}</div>
    <div class="prop-row">
      <label>Anchor</label>
      <div class="anchor-toggle">
        <button class="${leftActiveClass}" onclick="setAnchor('left')">&#9664; Left</button>
        <button class="${rightActiveClass}" onclick="setAnchor('right')">Right &#9654;</button>
      </div>
    </div>
    <div class="prop-row">
      <label>${posLabel} (px)</label>
      <input type="number" step="1" value="${item.x}" onchange="setProp('x', this.value)">
    </div>
    <div class="prop-row">
      <label>Top (px)</label>
      <input type="number" step="1" value="${item.y}" onchange="setProp('y', this.value)">
    </div>
    <div class="prop-row">
      <label>Width (px)</label>
      <input type="number" step="1" value="${item.width}" onchange="setProp('width', this.value)">
    </div>
    <div class="prop-row">
      <label>Rotation</label>
      <input type="number" step="1" value="${item.rotation}" onchange="setProp('rotation', this.value)">
    </div>
    <div class="prop-row">
      <label>Z-Index</label>
      <input type="number" step="1" value="${item.zIndex}" onchange="setProp('zIndex', this.value)">
    </div>
    <div style="margin-top:10px;font-size:11px;color:#666;">
      Arrows: move 1px (Shift: 10px)<br>
      [ ] : rotate &plusmn; 1&deg;<br>
      - + : resize &plusmn; 5px<br>
      , . : z-index &plusmn; 1
    </div>
  `;
}

function setProp(prop, value) {
  if (selected === null) return;
  const num = parseFloat(value);
  if (isNaN(num)) return;
  const item = items[selected];
  if (prop === 'x') item.x = Math.round(num);
  else if (prop === 'y') item.y = Math.round(num);
  else if (prop === 'width') item.width = Math.max(20, Math.round(num));
  else if (prop === 'rotation') item.rotation = num;
  else if (prop === 'zIndex') item.zIndex = num;
  updateElement(selected);
}

function updateList() {
  const list = document.getElementById('item-list');
  list.innerHTML = items.map((item, i) => {
    const badgeClass = item.anchor === 'right' ? 'right' : 'left';
    const badgeLabel = item.anchor === 'right' ? 'R' : 'L';
    const posLabel = item.anchor === 'right' ? 'r' : 'l';
    return `
      <div class="item-list-entry ${i === selected ? 'active' : ''}" onclick="selectItem(${i})">
        <span><span class="anchor-badge ${badgeClass}">${badgeLabel}</span>${item.id}</span>
        <span style="color:#666">${posLabel}:${item.x} t:${item.y} ${item.width}px</span>
      </div>
    `;
  }).join('');
}

function updateCanvasDims() {
  const el = getCanvasEl();
  document.getElementById('canvas-dims').textContent =
    `Canvas: ${el.offsetWidth} × ${el.offsetHeight}`;
}

// ---- Mockup overlay ----

function toggleMockup() {
  const el = document.getElementById('mockup-overlay');
  el.style.display = el.style.display === 'none' ? 'block' : 'none';
}

function adjustOpacity(delta) {
  mockupOpacity = Math.max(0, Math.min(1, mockupOpacity + delta));
  document.getElementById('mockup-overlay').style.opacity = mockupOpacity;
}

// ---- Export ----

function exportPositions() {
  const altMap = {
    'tiger-stamp': 'Vintage tiger postage stamp',
    'blue-dragon': 'Blue dragon paper cutout illustration',
    'disco-ball': 'Disco ball hanging from chain',
    'concert-ticket': 'Vintage concert ticket stub',
    'gold-frame-bunny': 'Pink bunny painting in ornate gold frame',
    'coffee-ring': 'Coffee cup ring stain',
    'sun-face': 'Vintage engraved sun with face',
    'bookshelf': 'Antique bookshelf with leather-bound books',
    'earring-back': 'Ornate silver jhumka earring',
    'earring-front': 'Ornate silver jhumka earring',
    'f1-car': 'Vintage red Formula 1 race car illustration',
    'card-spades': 'Vintage 10 of spades playing card',
    'card-queen': 'Vintage Queen of Hearts playing card',
    'cd-disc': 'CD with Summer nights with friends written on it',
    'peony-back': 'Pink peony flower with green leaves',
    'peony-front': 'Pink peony flower with green leaves',
  };

  const srcMap = {
    'tiger-stamp': 'tiger-stamp.png',
    'blue-dragon': 'blue-dragon.png',
    'disco-ball': 'disco-ball.png',
    'concert-ticket': 'concert-ticket.png',
    'gold-frame-bunny': 'gold-frame-bunny.png',
    'coffee-ring': 'coffee-ring.png',
    'sun-face': 'sun-face.png',
    'bookshelf': 'bookshelf.png',
    'earring-back': 'earring.png',
    'earring-front': 'earring.png',
    'f1-car': 'f1-car.png',
    'card-spades': 'playing-card-spades.png',
    'card-queen': 'playing-card-queen.png',
    'cd-disc': 'cd-disc.png',
    'letter-T-1': 'letter-T.png',
    'letter-H-1': 'letter-H.png',
    'letter-A': 'letter-A.png',
    'letter-T-2': 'letter-T.png',
    'letter-S': 'letter-S.png',
    'letter-H-2': 'letter-H.png',
    'letter-O': 'letter-O.png',
    'letter-T-3': 'letter-T.png',
    'peony-back': 'peony.png',
    'peony-front': 'peony.png',
  };

  let code = `export const collageImages: CollageImageData[] = [\n`;

  items.forEach(item => {
    const alt = altMap[item.id] || item.id.replace(/-/g, ' ');
    const filename = srcMap[item.id] || item.id + '.png';
    code += `  {\n`;
    code += `    id: '${item.id}',\n`;
    code += `    src: '/images/collage/${filename}',\n`;
    code += `    alt: '${alt}',\n`;
    code += `    anchor: '${item.anchor}',\n`;
    if (item.anchor === 'right') {
      code += `    right: ${item.x},\n`;
    } else {
      code += `    left: ${item.x},\n`;
    }
    code += `    top: ${item.y},\n`;
    code += `    width: ${item.width},\n`;
    code += `    rotation: ${item.rotation},\n`;
    code += `    zIndex: ${item.zIndex},\n`;
    code += `  },\n`;
  });

  code += `];\n`;

  document.getElementById('export-code').textContent = code;
  document.getElementById('export-modal').classList.add('show');
}

function closeExport() {
  document.getElementById('export-modal').classList.remove('show');
}

function copyExport() {
  exportPositions();
  const code = document.getElementById('export-code').textContent;
  navigator.clipboard.writeText(code).then(() => {
    document.getElementById('status').textContent = '\u2713 Copied to clipboard!';
    setTimeout(() => {
      document.getElementById('status').textContent = 'Drag images to position. All values in px.';
    }, 2000);
  });
}

// ---- Window resize: update canvas dims display ----
window.addEventListener('resize', updateCanvasDims);

// ---- Init ----
initItems();
createElements();
updateList();
updateProps();
updateCanvasDims();
</script>
</body>
</html>
